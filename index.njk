<!DOCTYPE html>
<html lang="cs" data-theme="ivory">
  <head>
    <meta charset="utf-8" />
    <title>üéâ ACGA Prom 2026</title>

    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
      :root {
        --bar-height: 3rem;
        --safe-height: calc(100dvh - var(--bar-height));
        --fade-duration: 400ms;
        --ease-main: cubic-bezier(0.25, 0.1, 0.25, 1);
      }

      :root[data-theme="ivory"] {
        --bg-main: #fefffa;
        --button-primary: rgba(255, 255, 255, 0.2); /* Semi-transparent white buttons */
        --button-secondary: rgba(0, 0, 0, 0.3); /* Darker bar for white text contrast */
        --text-primary: #ffffff;
        --text-secondary: rgba(255, 255, 255, 0.8);
        --accent-red: #ac0f14;
      }

      body {
        margin: 0;
        background-image: url('./assets/background.jpeg');
        background-position: center center;
        background-repeat: no-repeat;
        background-size: cover;
        background-attachment: fixed;
        background-color: #000; /* Dark fallback */
        color: var(--text-primary);
        overflow: hidden;
        font-family: sans-serif;
      }

      /* Global text shadow to ensure white text is readable over any background */
      h1, h2, p, blockquote, button {
        text-shadow: 0 2px 4px rgba(0, 0, 0, 0.5);
      }

      .card {
        opacity: 0;
        transform: translateY(10px);
        transition:
          opacity var(--fade-duration) var(--ease-main),
          transform var(--fade-duration) var(--ease-main);
      }
      .card.is-visible {
        opacity: 1;
        transform: translateY(0);
      }
      
      #xScroller,
      #xScroller section {
        scrollbar-width: none;
        -ms-overflow-style: none;
      }
      #xScroller::-webkit-scrollbar,
      #xScroller section::-webkit-scrollbar {
        display: none;
      }

      .class-btn {
        color: rgba(255, 255, 255, 0.6);
        text-shadow: none;
      }
      .class-btn.is-active {
        color: #ffffff;
      }

      #splash {
        position: fixed;
        inset: 0;
        z-index: 50;
        backdrop-filter: blur(12px);
        background: rgba(0, 0, 0, 0.2); 
        display: flex;
        align-items: center;
        justify-content: center;
        transition: opacity 600ms ease;
      }
      #splash.hidden {
        opacity: 0;
        pointer-events: none;
      }

      .splash-btn {
        background: var(--button-primary);
        border: 1px solid rgba(255, 255, 255, 0.3);
        backdrop-filter: blur(4px);
        line-height: 1;
      }
    </style>
  </head>

  <body>

    <div id="splash">
      <div class="flex flex-col items-center text-center px-6 max-w-xl">
        <h1 class="text-5xl font-black mb-4 tracking-tight" style="color: var(--accent-red); text-shadow: 0 2px 10px rgba(0,0,0,0.3);">
          PLES V OPE≈òE
        </h1>

        <p class="text-2xl font-black mb-2">
          Maturitn√≠ ples<br>Anglicko-ƒçesk√©ho gymn√°zia Amazon 2026
        </p>

        <p class="text-base text-[var(--text-secondary)] mb-8">
          Seznamte se s leto≈°n√≠mi maturanty t≈ô√≠d
        </p>

        <div class="grid grid-cols-2 gap-8">
          {% for room in classrooms %}
            <button
              data-room="{{ room }}"
              class="splash-btn w-32 h-32 sm:w-40 sm:h-40 rounded-2xl
                     text-3xl font-bold
                     text-white
                     shadow-2xl
                     transition
                     hover:bg-[rgba(255,255,255,0.3)]"
            >
              {{ room }}
            </button>
          {% endfor %}
        </div>
      </div>
    </div>

    <main
      id="xScroller"
      class="flex overflow-x-auto snap-x snap-mandatory scroll-smooth"
      style="height: var(--safe-height);"
    >
      {% for room in classrooms %}
        <section
          class="w-screen flex-shrink-0
                 overflow-y-auto
                 snap-center
                 snap-y snap-mandatory"
          data-room="{{ room }}"
        >
          {% for person in
            people_record
            | filter_classroom(room)
            | order_classroom
          %}
            <div
              class="h-[var(--safe-height)]
                     snap-center
                     flex"
            >
              <div
                class="card p-6
                       w-full h-full
                       grid grid-rows-[1fr_auto]
                       items-stretch"
              >
                <div class="pb-8 w-full h-full overflow-hidden flex items-center justify-center">
                  <img
                    src="/assets/{{ person.asset_name }}"
                    alt="{{ person | display_name }}"
                    loading="lazy"
                    onload="this.closest('.card').classList.add('is-visible')"
                    class="max-w-full max-h-full object-contain rounded-2xl shadow-lg border border-white/10"
                  />
                </div>

                <div class="text-center pb-4">
                  <h2 class="text-3xl sm:text-5xl font-bold mb-1 drop-shadow-md">
                    {{ person | display_name }}
                  </h2>

                  {% if person.quote %}
                    <blockquote class="text-xl font-black italic text-base text-[var(--text-primary)] mx-auto drop-shadow-md">
                      ‚Äú{{ person.quote }}‚Äù
                    </blockquote>
                  {% endif %}
                </div>

              </div>
            </div>
          {% endfor %}
        </section>
      {% endfor %}
    </main>

    <nav
      class="sticky bottom-0 z-30 backdrop-blur-xl"
      style="height: var(--bar-height); background: var(--button-secondary); border-top: 1px solid rgba(255,255,255,0.1);"
    >
      <div
        id="classBar"
        class="relative h-full grid grid-cols-{{ classrooms | length }}"
      >
        <div
          id="activeIndicator"
          class="absolute inset-y-0 left-0
                 transition-transform duration-300 ease-out"
          style="
            width: calc(100% / {{ classrooms | length }});
            background: rgba(255, 255, 255, 0.15);
          "
        ></div>

        {% for room in classrooms %}
          <button class="class-btn z-10 flex items-center justify-center font-bold uppercase tracking-widest text-sm">
            {{ room }}
          </button>
        {% endfor %}
      </div>
    </nav>

    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <script>
      const scroller = document.getElementById('xScroller');
      const classButtons = [...document.querySelectorAll('.class-btn')];
      const splash = document.getElementById('splash');
      const splashButtons = splash.querySelectorAll('button');
      const indicator = document.getElementById('activeIndicator');

      function scrollToRoom(index, behavior = 'smooth') {
        scroller.scrollTo({
          left: index * window.innerWidth,
          behavior
        });
      }

      function updateIndicator() {
        const index = Math.round(scroller.scrollLeft / window.innerWidth);
        indicator.style.transform = `translateX(${index * 100}%)`;

        classButtons.forEach((btn, i) =>
          btn.classList.toggle('is-active', i === index)
        );
      }

      classButtons.forEach((btn, index) => {
        btn.addEventListener('click', () => scrollToRoom(index));
      });

      function splashExplosion() {
        const colors = ['#ac0f14', '#ffffff', '#facc15']; // Red, White, Gold
        const BURST_COUNT = 4;

        for (let i = 0; i < BURST_COUNT; i++) {
          const f = 1 + (i * 0.2);
          const x = Math.random() * 0.2 + 0.4;
          const y = Math.random() * 0.2 + 0.4;
          const count = (Math.floor(Math.random() * 100) + 100) * f;
          const delay = (Math.random() * 25 + 350) * f;

          setTimeout(() => {
            confetti({
              particleCount: count,
              spread: 360,
              startVelocity: 25 * f,
              origin: { x, y },
              colors
            });
          }, delay * (i + 1));
        }
      }
      
      splashButtons.forEach((btn, index) => {
        btn.addEventListener('click', () => {
          scrollToRoom(index, 'auto');
          splash.classList.add('hidden');
        });
      });

      scroller.addEventListener('scroll', () => {
        requestAnimationFrame(updateIndicator);
      });

      updateIndicator();
      splashExplosion();
    </script>

  </body>
</html>
